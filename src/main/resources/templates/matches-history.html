<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:insert="/fragments/head :: head"></head>

<body class="dark-edition" style="background-image: url(/img/background.jpg)">
<div class="wrapper ">

   <!--Side Bar-->
   <div th:insert="fragments/sidebar :: sidebar"></div>
   <!--End Side Bar-->

   <div class="main-panel">
      <!-- Navbar -->
      <nav th:insert="/fragments/navbar :: navbar"></nav>
      <!-- End Navbar -->
      <div class="content">
         <div class="container-fluid">
            <div class="row">
               <div class="col-md-12">
                  <div class="card">
                     <div class="card-header card-header-success">
                        <p class="gruzini-title">Matches History</p>
                     </div>
                     <div class="card-body table-responsive">
                        <table class="table table-hover">
                           <!--                           TODO: add modal here for opponent -->
                           <thead class="text-warning">
                           <tr>
                              <th class="gruzini-text-card-content">ID</th>
                              <th class="gruzini-text-card-content">Opponent</th>
                              <th class="gruzini-text-card-content">Court</th>
                              <th class="gruzini-text-card-content">Date</th>
                              <th class="gruzini-text-card-content">Score</th>
                              <th class="gruzini-text-card-content">Win / Loss</th>
                           </tr>
                           </thead>
                           <tbody>
                           <tr th:each="match, iter : ${archivedMatches}">
                              <td class="gruzini-text-card-content" th:text="${iter.index+1}"></td>
                              <td class="gruzini-text-card-content">
                                 <span class="player-modal"
                                       th:attr="data-name=${match.opponent.getFullName()}, data-points=${match.opponent.rankingPoints},
                                                data-age=${match.opponent.age}, data-gender=${match.opponent.gender},
                                                data-photo=${match.opponent.photoUrl}"
                                       onclick="showModal(this.getAttribute('data-name'), this.getAttribute('data-points'),
                                                           this.getAttribute('data-age'), this.getAttribute('data-gender'),
                                                           this.getAttribute('data-photo'))"
                                       th:text="${match.opponent.getFullName()}">
                                 </span>
                              </td>
                              <td class="gruzini-text-card-content" th:text="${match.courtName}"></td>
                              <td class="gruzini-text-card-content" th:text="${match.date}"></td>
                              <td class="gruzini-text-card-content" th:text="${match.score}"></td>
                              <td></td>
                           </tr>
                           </tbody>
                        </table>
                     </div>
                  </div>
               </div>
            </div>
            <div id="playerModal" class="modal">
               <div class="modal-content card">
                  <div class="card-header card-header-success">
                     <span id="modalTitle" class="gruzini-title" style="display: inline;"></span>
                     <span class="close" style="display: inline;">&times;</span>
                  </div>
                  <div class="card-body table-responsive">
                     <img id="modalPhoto" class="gruzini-player-photo"><br />
                     <div style="float:left;">
                        <span class="gruzini-input-group-text" style="display: inline;">Age: </span>
                        <span id="modalAge" class="gruzini-input-group-text" style="display: inline;"></span>
                     </div><br />
                     <div style="float:left;">
                        <span class="gruzini-input-group-text" style="display: inline;">Gender: </span>
                        <span id="modalGender" class="gruzini-input-group-text" style="display: inline;"></span>
                     </div><br />
                     <div style="float:left;">
                        <span class="gruzini-input-group-text" style="display: inline;">Ranking points: </span>
                        <span id="modalPoints" class="gruzini-input-group-text" style="display: inline;"></span>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <!--FOOTER-->
      <footer th:insert="/fragments/footer :: footer"></footer>
      <!--END FOOTER-->
   </div>
</div>
<!--JAVASCRIPT IMPORTS-->
<div th:replace="/fragments/js-imports :: js-imports"></div>
<!--END JAVASCRIPT IMPORTS-->

<script>
   // Get the modal
   let modal = document.getElementById("playerModal");

   // Get the <span> element that closes the modal
   let span = document.getElementsByClassName("close")[0];

   let modalTitle = document.getElementById("modalTitle");
   let modalAge = document.getElementById("modalAge");
   let modalGender = document.getElementById("modalGender");
   let modalPoints = document.getElementById("modalPoints");
   let modalPhoto = document.getElementById("modalPhoto");

   function showModal(fullName, points, age, gender, photo) {
      modalTitle.textContent = fullName;
      modalAge.textContent = age;
      modalGender.textContent = gender;
      modalPoints.textContent = points;
      if(photo == null || photo === ''){
         if(gender === 'MALE'){
            modalPhoto.setAttribute('src', "/img/silhouette-male.png")
         }
         if(gender === 'FEMALE'){
            modalPhoto.setAttribute('src', "/img/silhouette-female.png")
         }
      } else {
         modalPhoto.setAttribute('src', photo);
      }

      modal.style.display = "block";
   }

   // When the user clicks on <span> (x), close the modal
   span.onclick = function () {
      modal.style.display = "none";
   }

   // When the user clicks anywhere outside of the modal, close it
   window.onclick = function (event) {
      if (event.target === modal) {
         modal.style.display = "none";
      }
   }
</script>

</body>

</html>